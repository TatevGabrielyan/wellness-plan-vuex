{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/**\r\n * DevExtreme (esm/viz/core/export.js)\r\n * Version: 22.1.6\r\n * Build date: Tue Oct 18 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { extend } from \"../../core/utils/extend\";\nimport { getWindow } from \"../../core/utils/window\";\nimport { patchFontOptions } from \"./utils\";\nimport { HIDDEN_FOR_EXPORT } from \"../../core/utils/svg\";\nimport { export as _export, image as imageExporter, svg as svgExporter, pdf as pdfExporter } from \"../../exporter\";\nimport messageLocalization from \"../../localization/message\";\nimport { isDefined } from \"../../core/utils/type\";\nimport { getTheme } from \"../themes\";\nimport { start as hoverEventStart, end as hoverEventEnd } from \"../../events/hover\";\nimport pointerEvents from \"../../events/pointer\";\nimport { logger } from \"../../core/utils/console\";\nimport { getWidth } from \"../../core/utils/size\";\nvar pointerActions = [pointerEvents.down, pointerEvents.move].join(\" \");\nvar BUTTON_SIZE = 35;\nvar ICON_COORDS = [[9, 12, 26, 12, 26, 14, 9, 14], [9, 17, 26, 17, 26, 19, 9, 19], [9, 22, 26, 22, 26, 24, 9, 24]];\nvar LIST_PADDING_TOP = 4;\nvar LIST_WIDTH = 120;\nvar VERTICAL_TEXT_MARGIN = 8;\nvar HORIZONTAL_TEXT_MARGIN = 15;\nvar MENU_ITEM_HEIGHT = 30;\nvar LIST_STROKE_WIDTH = 1;\nvar MARGIN = 10;\nvar SHADOW_OFFSET = 2;\nvar SHADOW_BLUR = 3;\nvar DEFAULT_EXPORT_FORMAT = \"PNG\";\nvar ALLOWED_IMAGE_FORMATS = [DEFAULT_EXPORT_FORMAT, \"JPEG\", \"GIF\"];\nvar ALLOWED_EXTRA_FORMATS = [\"PDF\", \"SVG\"];\nvar EXPORT_CSS_CLASS = \"dx-export-menu\";\nvar A4WidthCm = \"21cm\";\nvar EXPORT_DATA_KEY = \"export-element-type\";\nvar FORMAT_DATA_KEY = \"export-element-format\";\nvar GET_COLOR_REGEX = /data-backgroundcolor=\"([^\"]*)\"/;\nfunction getValidFormats() {\n  var imageFormats = imageExporter.testFormats(ALLOWED_IMAGE_FORMATS);\n  return {\n    unsupported: imageFormats.unsupported,\n    supported: imageFormats.supported.concat(ALLOWED_EXTRA_FORMATS)\n  };\n}\nfunction validateFormat(format, incidentOccurred, validFormats) {\n  validFormats = validFormats || getValidFormats();\n  format = String(format).toUpperCase();\n  if (-1 !== validFormats.supported.indexOf(format)) {\n    return format;\n  }\n  if (-1 !== validFormats.unsupported.indexOf(format)) {\n    incidentOccurred && incidentOccurred(\"W2108\", [format]);\n  }\n}\nfunction getCreatorFunc(format) {\n  if (\"SVG\" === format) {\n    return svgExporter.getData;\n  } else if (\"PDF\" === format) {\n    return pdfExporter.getData;\n  } else {\n    return imageExporter.getData;\n  }\n}\nfunction print(imageSrc, options) {\n  var document = getWindow().document;\n  var iFrame = document.createElement(\"iframe\");\n  iFrame.onload = setPrint(imageSrc, options);\n  iFrame.style.position = \"fixed\";\n  iFrame.style.width = \"0\";\n  iFrame.style.height = \"0\";\n  iFrame.style.right = \"0\";\n  iFrame.style.bottom = \"0\";\n  document.body.appendChild(iFrame);\n}\nfunction calculatePrintPageWidth(iFrameBody) {\n  iFrameBody.style.width = A4WidthCm;\n  var width = getWidth(iFrameBody);\n  iFrameBody.style.width = \"\";\n  return width;\n}\nfunction setPrint(imageSrc, options) {\n  return function () {\n    var window = this.contentWindow;\n    var img = window.document.createElement(\"img\");\n    window.document.body.appendChild(img);\n    var widthRatio = calculatePrintPageWidth(window.document.body) / options.width;\n    if (widthRatio < 1) {\n      window.document.body.style.transform = \"scale(\".concat(widthRatio, \")\");\n      window.document.body.style[\"transform-origin\"] = \"0 0\";\n    }\n    var removeFrame = () => {\n      this.parentElement.removeChild(this);\n    };\n    img.addEventListener(\"load\", () => {\n      window.focus();\n      window.print();\n    });\n    img.addEventListener(\"error\", removeFrame);\n    window.addEventListener(\"afterprint\", () => {\n      setTimeout(removeFrame, 0);\n    });\n    img.src = imageSrc;\n  };\n}\nfunction getItemAttributes(options, type, itemIndex) {\n  var x = BUTTON_SIZE - LIST_WIDTH;\n  var y = BUTTON_SIZE + LIST_PADDING_TOP + LIST_STROKE_WIDTH + itemIndex * MENU_ITEM_HEIGHT;\n  var attr = {\n    rect: {\n      width: LIST_WIDTH - 2 * LIST_STROKE_WIDTH,\n      height: MENU_ITEM_HEIGHT,\n      x: x + LIST_STROKE_WIDTH,\n      y: y\n    },\n    text: {\n      x: x + (options.rtl ? LIST_WIDTH - HORIZONTAL_TEXT_MARGIN : HORIZONTAL_TEXT_MARGIN),\n      y: y + MENU_ITEM_HEIGHT - VERTICAL_TEXT_MARGIN\n    }\n  };\n  if (\"printing\" === type) {\n    attr.separator = {\n      stroke: options.button.default.borderColor,\n      \"stroke-width\": LIST_STROKE_WIDTH,\n      cursor: \"pointer\",\n      sharp: \"v\",\n      d: \"M \" + x + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH) + \" L \" + (x + LIST_WIDTH) + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH)\n    };\n  }\n  return attr;\n}\nfunction createMenuItem(renderer, options, settings) {\n  var itemData = {};\n  var type = settings.type;\n  var format = settings.format;\n  var attr = getItemAttributes(options, type, settings.itemIndex);\n  var fontStyle = patchFontOptions(options.font);\n  fontStyle[\"pointer-events\"] = \"none\";\n  var menuItem = renderer.g().attr({\n    class: EXPORT_CSS_CLASS + \"-list-item\"\n  });\n  itemData[EXPORT_DATA_KEY] = type;\n  if (format) {\n    itemData[FORMAT_DATA_KEY] = format;\n  }\n  var rect = renderer.rect();\n  rect.attr(attr.rect).css({\n    cursor: \"pointer\",\n    \"pointer-events\": \"all\"\n  }).data(itemData);\n  rect.on(hoverEventStart + \".export\", () => rect.attr({\n    fill: options.button.hover.backgroundColor\n  })).on(hoverEventEnd + \".export\", () => rect.attr({\n    fill: null\n  }));\n  rect.append(menuItem);\n  var text = renderer.text(settings.text).css(fontStyle).attr(attr.text).append(menuItem);\n  if (\"printing\" === type) {\n    renderer.path(null, \"line\").attr(attr.separator).append(menuItem);\n  }\n  return {\n    g: menuItem,\n    rect: rect,\n    resetState: () => rect.attr({\n      fill: null\n    }),\n    fixPosition: () => {\n      var textBBox = text.getBBox();\n      text.move(attr.text.x - textBBox.x - (options.rtl ? textBBox.width : 0));\n    }\n  };\n}\nfunction createMenuItems(renderer, options) {\n  var items = [];\n  if (options.printingEnabled) {\n    items.push(createMenuItem(renderer, options, {\n      type: \"printing\",\n      text: messageLocalization.format(\"vizExport-printingButtonText\"),\n      itemIndex: items.length\n    }));\n  }\n  items = options.formats.reduce((r, format) => {\n    r.push(createMenuItem(renderer, options, {\n      type: \"exporting\",\n      text: messageLocalization.getFormatter(\"vizExport-exportButtonText\")(format),\n      format: format,\n      itemIndex: r.length\n    }));\n    return r;\n  }, items);\n  return items;\n}\nfunction getBackgroundColorFromMarkup(markup) {\n  var parsedMarkup = GET_COLOR_REGEX.exec(markup);\n  return null === parsedMarkup || void 0 === parsedMarkup ? void 0 : parsedMarkup[1];\n}\nexport var exportFromMarkup = function (markup, options) {\n  options.format = validateFormat(options.format) || DEFAULT_EXPORT_FORMAT;\n  options.fileName = options.fileName || \"file\";\n  options.exportingAction = options.onExporting;\n  options.exportedAction = options.onExported;\n  options.fileSavingAction = options.onFileSaving;\n  options.margin = isDefined(options.margin) ? options.margin : MARGIN;\n  options.backgroundColor = isDefined(options.backgroundColor) ? options.backgroundColor : getBackgroundColorFromMarkup(markup) || getTheme().backgroundColor;\n  _export(markup, options, getCreatorFunc(options.format));\n};\nexport var getMarkup = widgets => combineMarkups(widgets).markup;\nexport var exportWidgets = function (widgets, options) {\n  options = options || {};\n  var markupInfo = combineMarkups(widgets, {\n    gridLayout: options.gridLayout,\n    verticalAlignment: options.verticalAlignment,\n    horizontalAlignment: options.horizontalAlignment\n  });\n  options.width = markupInfo.width;\n  options.height = markupInfo.height;\n  exportFromMarkup(markupInfo.markup, options);\n};\nexport var combineMarkups = function (widgets) {\n  var options = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n  if (!Array.isArray(widgets)) {\n    widgets = [[widgets]];\n  } else if (!Array.isArray(widgets[0])) {\n    widgets = widgets.map(item => [item]);\n  }\n  var compactView = !options.gridLayout;\n  var exportItems = widgets.reduce((r, row, rowIndex) => {\n    var rowInfo = row.reduce((r, item, colIndex) => {\n      var size = item.getSize();\n      var backgroundColor = item.option(\"backgroundColor\") || getTheme(item.option(\"theme\")).backgroundColor;\n      backgroundColor && -1 === r.backgroundColors.indexOf(backgroundColor) && r.backgroundColors.push(backgroundColor);\n      r.hOffset = r.width;\n      r.width += size.width;\n      r.height = Math.max(r.height, size.height);\n      r.itemWidth = Math.max(r.itemWidth, size.width);\n      r.items.push({\n        markup: item.svg(),\n        width: size.width,\n        height: size.height,\n        c: colIndex,\n        r: rowIndex,\n        hOffset: r.hOffset\n      });\n      return r;\n    }, {\n      items: [],\n      height: 0,\n      itemWidth: 0,\n      hOffset: 0,\n      width: 0,\n      backgroundColors: r.backgroundColors\n    });\n    r.rowOffsets.push(r.totalHeight);\n    r.rowHeights.push(rowInfo.height);\n    r.totalHeight += rowInfo.height;\n    r.items = r.items.concat(rowInfo.items);\n    r.itemWidth = Math.max(r.itemWidth, rowInfo.itemWidth);\n    r.maxItemLen = Math.max(r.maxItemLen, rowInfo.items.length);\n    r.totalWidth = compactView ? Math.max(r.totalWidth, rowInfo.width) : r.maxItemLen * r.itemWidth;\n    return r;\n  }, {\n    items: [],\n    rowOffsets: [],\n    rowHeights: [],\n    itemWidth: 0,\n    totalHeight: 0,\n    maxItemLen: 0,\n    totalWidth: 0,\n    backgroundColors: []\n  });\n  var backgroundColor = 'data-backgroundcolor=\"'.concat(1 === exportItems.backgroundColors.length ? exportItems.backgroundColors[0] : \"\", '\" ');\n  var getVOffset = item => {\n    var align = options.verticalAlignment;\n    var dy = exportItems.rowHeights[item.r] - item.height;\n    return exportItems.rowOffsets[item.r] + (\"bottom\" === align ? dy : \"center\" === align ? dy / 2 : 0);\n  };\n  var getHOffset = item => {\n    if (compactView) {\n      return item.hOffset;\n    }\n    var align = options.horizontalAlignment;\n    var colWidth = exportItems.itemWidth;\n    var dx = colWidth - item.width;\n    return item.c * colWidth + (\"right\" === align ? dx : \"center\" === align ? dx / 2 : 0);\n  };\n  var totalHeight = exportItems.totalHeight;\n  var totalWidth = exportItems.totalWidth;\n  return {\n    markup: \"<svg \" + backgroundColor + 'height=\"' + totalHeight + '\" width=\"' + totalWidth + '\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">' + exportItems.items.map(item => '<g transform=\"translate('.concat(getHOffset(item), \",\").concat(getVOffset(item), ')\">').concat(item.markup, \"</g>\")).join(\"\") + \"</svg>\",\n    width: totalWidth,\n    height: totalHeight\n  };\n};\nexport var ExportMenu = function (params) {\n  var renderer = this._renderer = params.renderer;\n  this._incidentOccurred = params.incidentOccurred;\n  this._exportTo = params.exportTo;\n  this._print = params.print;\n  this._shadow = renderer.shadowFilter(\"-50%\", \"-50%\", \"200%\", \"200%\", SHADOW_OFFSET, 6, SHADOW_BLUR);\n  this._shadow.attr({\n    opacity: .8\n  });\n  this._group = renderer.g().attr({\n    class: EXPORT_CSS_CLASS,\n    [HIDDEN_FOR_EXPORT]: true\n  }).linkOn(renderer.root, {\n    name: \"export-menu\",\n    after: \"peripheral\"\n  });\n  this._buttonGroup = renderer.g().attr({\n    class: EXPORT_CSS_CLASS + \"-button\"\n  }).append(this._group);\n  this._listGroup = renderer.g().attr({\n    class: EXPORT_CSS_CLASS + \"-list\"\n  }).append(this._group);\n  this._overlay = renderer.rect(-LIST_WIDTH + BUTTON_SIZE, BUTTON_SIZE + LIST_PADDING_TOP, LIST_WIDTH, 0);\n  this._overlay.attr({\n    \"stroke-width\": LIST_STROKE_WIDTH,\n    cursor: \"pointer\",\n    rx: 4,\n    ry: 4,\n    filter: this._shadow.id\n  });\n  this._overlay.data({\n    \"export-element-type\": \"list\"\n  });\n  this.validFormats = getValidFormats();\n  this._subscribeEvents();\n};\nextend(ExportMenu.prototype, {\n  getLayoutOptions() {\n    if (this._hiddenDueToLayout) {\n      return {\n        width: 0,\n        height: 0,\n        cutSide: \"vertical\",\n        cutLayoutSide: \"top\"\n      };\n    }\n    var bBox = this._buttonGroup.getBBox();\n    bBox.cutSide = \"vertical\";\n    bBox.cutLayoutSide = \"top\";\n    bBox.height += MARGIN;\n    bBox.position = {\n      vertical: \"top\",\n      horizontal: \"right\"\n    };\n    bBox.verticalAlignment = \"top\";\n    bBox.horizontalAlignment = \"right\";\n    return bBox;\n  },\n  shift(_, y) {\n    this._group.attr({\n      translateY: this._group.attr(\"translateY\") + y\n    });\n  },\n  draw(width, height, canvas) {\n    this._group.move(width - BUTTON_SIZE - SHADOW_OFFSET - SHADOW_BLUR + canvas.left, Math.floor(height / 2 - BUTTON_SIZE / 2));\n    var layoutOptions = this.getLayoutOptions();\n    if (layoutOptions.width > width || layoutOptions.height > height) {\n      this.freeSpace();\n    }\n    return this;\n  },\n  show() {\n    this._group.linkAppend();\n  },\n  hide() {\n    this._group.linkRemove();\n  },\n  setOptions(options) {\n    this._options = options;\n    if (options.formats) {\n      options.formats = options.formats.reduce((r, format) => {\n        format = validateFormat(format, this._incidentOccurred, this.validFormats);\n        format && r.push(format);\n        return r;\n      }, []);\n    } else {\n      options.formats = this.validFormats.supported.slice();\n    }\n    options.printingEnabled = void 0 === options.printingEnabled ? true : options.printingEnabled;\n    if (options.enabled && (options.formats.length || options.printingEnabled)) {\n      this.show();\n      this._updateButton();\n      this._updateList();\n      this._hideList();\n    } else {\n      this.hide();\n    }\n  },\n  dispose() {\n    this._unsubscribeEvents();\n    this._group.linkRemove().linkOff();\n    this._group.dispose();\n    this._shadow.dispose();\n  },\n  layoutOptions() {\n    return this._options.enabled && {\n      horizontalAlignment: \"right\",\n      verticalAlignment: \"top\",\n      weak: true\n    };\n  },\n  measure() {\n    this._fillSpace();\n    var margin = this._options.button.margin;\n    return [BUTTON_SIZE + margin.left + margin.right, BUTTON_SIZE + margin.top + margin.bottom];\n  },\n  move(rect) {\n    var margin = this._options.button.margin;\n    this._group.attr({\n      translateX: Math.round(rect[0]) + margin.left,\n      translateY: Math.round(rect[1]) + margin.top\n    });\n  },\n  _fillSpace() {\n    this._hiddenDueToLayout = false;\n    this.show();\n  },\n  freeSpace() {\n    this._incidentOccurred(\"W2107\");\n    this._hiddenDueToLayout = true;\n    this.hide();\n  },\n  _hideList() {\n    this._listGroup.remove();\n    this._listShown = false;\n    this._setButtonState(\"default\");\n    this._menuItems.forEach(item => item.resetState());\n  },\n  _showList() {\n    this._listGroup.append(this._group);\n    this._listShown = true;\n    this._menuItems.forEach(item => item.fixPosition());\n  },\n  _setButtonState(state) {\n    var style = this._options.button[state];\n    this._button.attr({\n      stroke: style.borderColor,\n      fill: style.backgroundColor\n    });\n    this._icon.attr({\n      fill: style.color\n    });\n  },\n  _subscribeEvents() {\n    this._renderer.root.on(pointerEvents.up + \".export\", e => {\n      var elementType = e.target[EXPORT_DATA_KEY];\n      if (!elementType) {\n        if (this._button) {\n          this._hideList();\n        }\n        return;\n      }\n      if (\"button\" === elementType) {\n        if (this._listShown) {\n          this._setButtonState(\"default\");\n          this._hideList();\n        } else {\n          this._setButtonState(\"focus\");\n          this._showList();\n        }\n      } else if (\"printing\" === elementType) {\n        this._print();\n        this._hideList();\n      } else if (\"exporting\" === elementType) {\n        this._exportTo(e.target[FORMAT_DATA_KEY]);\n        this._hideList();\n      }\n    });\n    this._listGroup.on(pointerActions, e => e.stopPropagation());\n    this._buttonGroup.on(pointerEvents.enter, () => this._setButtonState(\"hover\"));\n    this._buttonGroup.on(pointerEvents.leave, () => this._setButtonState(this._listShown ? \"focus\" : \"default\"));\n    this._buttonGroup.on(pointerEvents.down + \".export\", () => this._setButtonState(\"active\"));\n  },\n  _unsubscribeEvents() {\n    this._renderer.root.off(\".export\");\n    this._listGroup.off();\n    this._buttonGroup.off();\n  },\n  _updateButton() {\n    var renderer = this._renderer;\n    var options = this._options;\n    var exportData = {\n      \"export-element-type\": \"button\"\n    };\n    if (!this._button) {\n      this._button = renderer.rect(0, 0, BUTTON_SIZE, BUTTON_SIZE).append(this._buttonGroup);\n      this._button.attr({\n        rx: 4,\n        ry: 4,\n        fill: options.button.default.backgroundColor,\n        stroke: options.button.default.borderColor,\n        \"stroke-width\": 1,\n        cursor: \"pointer\"\n      });\n      this._button.data(exportData);\n      this._icon = renderer.path(ICON_COORDS).append(this._buttonGroup);\n      this._icon.attr({\n        fill: options.button.default.color,\n        cursor: \"pointer\"\n      });\n      this._icon.data(exportData);\n      this._buttonGroup.setTitle(messageLocalization.format(\"vizExport-titleMenuText\"));\n    }\n  },\n  _updateList() {\n    var options = this._options;\n    var buttonDefault = options.button.default;\n    var listGroup = this._listGroup;\n    var items = createMenuItems(this._renderer, options);\n    this._shadow.attr({\n      color: options.shadowColor\n    });\n    this._overlay.attr({\n      height: items.length * MENU_ITEM_HEIGHT + 2 * LIST_STROKE_WIDTH,\n      fill: buttonDefault.backgroundColor,\n      stroke: buttonDefault.borderColor\n    });\n    listGroup.clear();\n    this._overlay.append(listGroup);\n    items.forEach(item => item.g.append(listGroup));\n    this._menuItems = items;\n  }\n});\nfunction getExportOptions(widget, exportOptions, fileName, format) {\n  if (format || exportOptions.format) {\n    format = validateFormat(format || exportOptions.format, widget._incidentOccurred);\n  }\n  var {\n    width: width,\n    height: height\n  } = widget.getSize();\n  return {\n    format: format || DEFAULT_EXPORT_FORMAT,\n    fileName: fileName || exportOptions.fileName || \"file\",\n    proxyUrl: exportOptions.proxyUrl,\n    backgroundColor: exportOptions.backgroundColor,\n    width: width,\n    height: height,\n    margin: exportOptions.margin,\n    svgToCanvas: exportOptions.svgToCanvas,\n    forceProxy: exportOptions.forceProxy,\n    exportingAction: widget._createActionByOption(\"onExporting\", {\n      excludeValidators: [\"disabled\"]\n    }),\n    exportedAction: widget._createActionByOption(\"onExported\", {\n      excludeValidators: [\"disabled\"]\n    }),\n    fileSavingAction: widget._createActionByOption(\"onFileSaving\", {\n      excludeValidators: [\"disabled\"]\n    })\n  };\n}\nexport var plugin = {\n  name: \"export\",\n  init() {\n    this._exportMenu = new ExportMenu({\n      renderer: this._renderer,\n      incidentOccurred: this._incidentOccurred,\n      print: () => this.print(),\n      exportTo: format => this.exportTo(void 0, format)\n    });\n    this._layout.add(this._exportMenu);\n  },\n  dispose() {\n    this._exportMenu.dispose();\n  },\n  members: {\n    _getExportMenuOptions() {\n      return extend({}, this._getOption(\"export\"), {\n        rtl: this._getOption(\"rtlEnabled\", true)\n      });\n    },\n    _disablePointerEvents() {\n      var pointerEventsValue = this._renderer.root.attr(\"pointer-events\");\n      this._renderer.root.attr({\n        \"pointer-events\": \"none\"\n      });\n      return pointerEventsValue;\n    },\n    exportTo(fileName, format) {\n      var menu = this._exportMenu;\n      var options = getExportOptions(this, this._getOption(\"export\") || {}, fileName, format);\n      menu && menu.hide();\n      var pointerEventsValue = this._disablePointerEvents();\n      var promise = _export(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(logger.error).always(() => {\n        this._renderer.root.attr({\n          \"pointer-events\": pointerEventsValue\n        });\n      });\n      menu && menu.show();\n      return promise;\n    },\n    print() {\n      var menu = this._exportMenu;\n      var options = getExportOptions(this, this._getOption(\"export\") || {});\n      options.exportingAction = null;\n      options.exportedAction = null;\n      options.margin = 0;\n      options.format = \"PNG\";\n      options.forceProxy = true;\n      options.fileSavingAction = eventArgs => {\n        print(\"data:image/png;base64,\".concat(eventArgs.data), {\n          width: options.width,\n          __test: options.__test\n        });\n        eventArgs.cancel = true;\n      };\n      var pointerEventsValue = this._disablePointerEvents();\n      menu && menu.hide();\n      var promise = _export(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(logger.error).always(() => {\n        this._renderer.root.attr({\n          \"pointer-events\": pointerEventsValue\n        });\n      });\n      menu && menu.show();\n      return promise;\n    }\n  },\n  customize(constructor) {\n    var proto = constructor.prototype;\n    constructor.addChange({\n      code: \"EXPORT\",\n      handler() {\n        this._exportMenu.setOptions(this._getExportMenuOptions());\n        this._change([\"LAYOUT\"]);\n      },\n      isThemeDependent: true,\n      isOptionChange: true,\n      option: \"export\"\n    });\n    proto._optionChangesMap.onExporting = \"EXPORT\";\n    proto._optionChangesMap.onExported = \"EXPORT\";\n    proto._optionChangesMap.onFileSaving = \"EXPORT\";\n  },\n  fontFields: [\"export.font\"]\n};","map":{"version":3,"names":["extend","getWindow","patchFontOptions","HIDDEN_FOR_EXPORT","export","_export","image","imageExporter","svg","svgExporter","pdf","pdfExporter","messageLocalization","isDefined","getTheme","start","hoverEventStart","end","hoverEventEnd","pointerEvents","logger","getWidth","pointerActions","down","move","join","BUTTON_SIZE","ICON_COORDS","LIST_PADDING_TOP","LIST_WIDTH","VERTICAL_TEXT_MARGIN","HORIZONTAL_TEXT_MARGIN","MENU_ITEM_HEIGHT","LIST_STROKE_WIDTH","MARGIN","SHADOW_OFFSET","SHADOW_BLUR","DEFAULT_EXPORT_FORMAT","ALLOWED_IMAGE_FORMATS","ALLOWED_EXTRA_FORMATS","EXPORT_CSS_CLASS","A4WidthCm","EXPORT_DATA_KEY","FORMAT_DATA_KEY","GET_COLOR_REGEX","getValidFormats","imageFormats","testFormats","unsupported","supported","concat","validateFormat","format","incidentOccurred","validFormats","String","toUpperCase","indexOf","getCreatorFunc","getData","print","imageSrc","options","document","iFrame","createElement","onload","setPrint","style","position","width","height","right","bottom","body","appendChild","calculatePrintPageWidth","iFrameBody","window","contentWindow","img","widthRatio","transform","removeFrame","parentElement","removeChild","addEventListener","focus","setTimeout","src","getItemAttributes","type","itemIndex","x","y","attr","rect","text","rtl","separator","stroke","button","default","borderColor","cursor","sharp","d","createMenuItem","renderer","settings","itemData","fontStyle","font","menuItem","g","class","css","data","on","fill","hover","backgroundColor","append","path","resetState","fixPosition","textBBox","getBBox","createMenuItems","items","printingEnabled","push","length","formats","reduce","r","getFormatter","getBackgroundColorFromMarkup","markup","parsedMarkup","exec","exportFromMarkup","fileName","exportingAction","onExporting","exportedAction","onExported","fileSavingAction","onFileSaving","margin","getMarkup","widgets","combineMarkups","exportWidgets","markupInfo","gridLayout","verticalAlignment","horizontalAlignment","arguments","Array","isArray","map","item","compactView","exportItems","row","rowIndex","rowInfo","colIndex","size","getSize","option","backgroundColors","hOffset","Math","max","itemWidth","c","rowOffsets","totalHeight","rowHeights","maxItemLen","totalWidth","getVOffset","align","dy","getHOffset","colWidth","dx","ExportMenu","params","_renderer","_incidentOccurred","_exportTo","exportTo","_print","_shadow","shadowFilter","opacity","_group","linkOn","root","name","after","_buttonGroup","_listGroup","_overlay","rx","ry","filter","id","_subscribeEvents","prototype","getLayoutOptions","_hiddenDueToLayout","cutSide","cutLayoutSide","bBox","vertical","horizontal","shift","_","translateY","draw","canvas","left","floor","layoutOptions","freeSpace","show","linkAppend","hide","linkRemove","setOptions","_options","slice","enabled","_updateButton","_updateList","_hideList","dispose","_unsubscribeEvents","linkOff","weak","measure","_fillSpace","top","translateX","round","remove","_listShown","_setButtonState","_menuItems","forEach","_showList","state","_button","_icon","color","up","e","elementType","target","stopPropagation","enter","leave","off","exportData","setTitle","buttonDefault","listGroup","shadowColor","clear","getExportOptions","widget","exportOptions","proxyUrl","svgToCanvas","forceProxy","_createActionByOption","excludeValidators","plugin","init","_exportMenu","_layout","add","members","_getExportMenuOptions","_getOption","_disablePointerEvents","pointerEventsValue","menu","promise","element","fail","error","always","eventArgs","__test","cancel","customize","constructor","proto","addChange","code","handler","_change","isThemeDependent","isOptionChange","_optionChangesMap","fontFields"],"sources":["C:/Users/User/vue-chart/node_modules/devextreme/esm/viz/core/export.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/viz/core/export.js)\r\n * Version: 22.1.6\r\n * Build date: Tue Oct 18 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    getWindow\r\n} from \"../../core/utils/window\";\r\nimport {\r\n    patchFontOptions\r\n} from \"./utils\";\r\nimport {\r\n    HIDDEN_FOR_EXPORT\r\n} from \"../../core/utils/svg\";\r\nimport {\r\n    export as _export,\r\n    image as imageExporter,\r\n    svg as svgExporter,\r\n    pdf as pdfExporter\r\n} from \"../../exporter\";\r\nimport messageLocalization from \"../../localization/message\";\r\nimport {\r\n    isDefined\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    getTheme\r\n} from \"../themes\";\r\nimport {\r\n    start as hoverEventStart,\r\n    end as hoverEventEnd\r\n} from \"../../events/hover\";\r\nimport pointerEvents from \"../../events/pointer\";\r\nimport {\r\n    logger\r\n} from \"../../core/utils/console\";\r\nimport {\r\n    getWidth\r\n} from \"../../core/utils/size\";\r\nvar pointerActions = [pointerEvents.down, pointerEvents.move].join(\" \");\r\nvar BUTTON_SIZE = 35;\r\nvar ICON_COORDS = [\r\n    [9, 12, 26, 12, 26, 14, 9, 14],\r\n    [9, 17, 26, 17, 26, 19, 9, 19],\r\n    [9, 22, 26, 22, 26, 24, 9, 24]\r\n];\r\nvar LIST_PADDING_TOP = 4;\r\nvar LIST_WIDTH = 120;\r\nvar VERTICAL_TEXT_MARGIN = 8;\r\nvar HORIZONTAL_TEXT_MARGIN = 15;\r\nvar MENU_ITEM_HEIGHT = 30;\r\nvar LIST_STROKE_WIDTH = 1;\r\nvar MARGIN = 10;\r\nvar SHADOW_OFFSET = 2;\r\nvar SHADOW_BLUR = 3;\r\nvar DEFAULT_EXPORT_FORMAT = \"PNG\";\r\nvar ALLOWED_IMAGE_FORMATS = [DEFAULT_EXPORT_FORMAT, \"JPEG\", \"GIF\"];\r\nvar ALLOWED_EXTRA_FORMATS = [\"PDF\", \"SVG\"];\r\nvar EXPORT_CSS_CLASS = \"dx-export-menu\";\r\nvar A4WidthCm = \"21cm\";\r\nvar EXPORT_DATA_KEY = \"export-element-type\";\r\nvar FORMAT_DATA_KEY = \"export-element-format\";\r\nvar GET_COLOR_REGEX = /data-backgroundcolor=\"([^\"]*)\"/;\r\n\r\nfunction getValidFormats() {\r\n    var imageFormats = imageExporter.testFormats(ALLOWED_IMAGE_FORMATS);\r\n    return {\r\n        unsupported: imageFormats.unsupported,\r\n        supported: imageFormats.supported.concat(ALLOWED_EXTRA_FORMATS)\r\n    }\r\n}\r\n\r\nfunction validateFormat(format, incidentOccurred, validFormats) {\r\n    validFormats = validFormats || getValidFormats();\r\n    format = String(format).toUpperCase();\r\n    if (-1 !== validFormats.supported.indexOf(format)) {\r\n        return format\r\n    }\r\n    if (-1 !== validFormats.unsupported.indexOf(format)) {\r\n        incidentOccurred && incidentOccurred(\"W2108\", [format])\r\n    }\r\n}\r\n\r\nfunction getCreatorFunc(format) {\r\n    if (\"SVG\" === format) {\r\n        return svgExporter.getData\r\n    } else if (\"PDF\" === format) {\r\n        return pdfExporter.getData\r\n    } else {\r\n        return imageExporter.getData\r\n    }\r\n}\r\n\r\nfunction print(imageSrc, options) {\r\n    var document = getWindow().document;\r\n    var iFrame = document.createElement(\"iframe\");\r\n    iFrame.onload = setPrint(imageSrc, options);\r\n    iFrame.style.position = \"fixed\";\r\n    iFrame.style.width = \"0\";\r\n    iFrame.style.height = \"0\";\r\n    iFrame.style.right = \"0\";\r\n    iFrame.style.bottom = \"0\";\r\n    document.body.appendChild(iFrame)\r\n}\r\n\r\nfunction calculatePrintPageWidth(iFrameBody) {\r\n    iFrameBody.style.width = A4WidthCm;\r\n    var width = getWidth(iFrameBody);\r\n    iFrameBody.style.width = \"\";\r\n    return width\r\n}\r\n\r\nfunction setPrint(imageSrc, options) {\r\n    return function() {\r\n        var window = this.contentWindow;\r\n        var img = window.document.createElement(\"img\");\r\n        window.document.body.appendChild(img);\r\n        var widthRatio = calculatePrintPageWidth(window.document.body) / options.width;\r\n        if (widthRatio < 1) {\r\n            window.document.body.style.transform = \"scale(\".concat(widthRatio, \")\");\r\n            window.document.body.style[\"transform-origin\"] = \"0 0\"\r\n        }\r\n        var removeFrame = () => {\r\n            this.parentElement.removeChild(this)\r\n        };\r\n        img.addEventListener(\"load\", () => {\r\n            window.focus();\r\n            window.print()\r\n        });\r\n        img.addEventListener(\"error\", removeFrame);\r\n        window.addEventListener(\"afterprint\", () => {\r\n            setTimeout(removeFrame, 0)\r\n        });\r\n        img.src = imageSrc\r\n    }\r\n}\r\n\r\nfunction getItemAttributes(options, type, itemIndex) {\r\n    var x = BUTTON_SIZE - LIST_WIDTH;\r\n    var y = BUTTON_SIZE + LIST_PADDING_TOP + LIST_STROKE_WIDTH + itemIndex * MENU_ITEM_HEIGHT;\r\n    var attr = {\r\n        rect: {\r\n            width: LIST_WIDTH - 2 * LIST_STROKE_WIDTH,\r\n            height: MENU_ITEM_HEIGHT,\r\n            x: x + LIST_STROKE_WIDTH,\r\n            y: y\r\n        },\r\n        text: {\r\n            x: x + (options.rtl ? LIST_WIDTH - HORIZONTAL_TEXT_MARGIN : HORIZONTAL_TEXT_MARGIN),\r\n            y: y + MENU_ITEM_HEIGHT - VERTICAL_TEXT_MARGIN\r\n        }\r\n    };\r\n    if (\"printing\" === type) {\r\n        attr.separator = {\r\n            stroke: options.button.default.borderColor,\r\n            \"stroke-width\": LIST_STROKE_WIDTH,\r\n            cursor: \"pointer\",\r\n            sharp: \"v\",\r\n            d: \"M \" + x + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH) + \" L \" + (x + LIST_WIDTH) + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH)\r\n        }\r\n    }\r\n    return attr\r\n}\r\n\r\nfunction createMenuItem(renderer, options, settings) {\r\n    var itemData = {};\r\n    var type = settings.type;\r\n    var format = settings.format;\r\n    var attr = getItemAttributes(options, type, settings.itemIndex);\r\n    var fontStyle = patchFontOptions(options.font);\r\n    fontStyle[\"pointer-events\"] = \"none\";\r\n    var menuItem = renderer.g().attr({\r\n        class: EXPORT_CSS_CLASS + \"-list-item\"\r\n    });\r\n    itemData[EXPORT_DATA_KEY] = type;\r\n    if (format) {\r\n        itemData[FORMAT_DATA_KEY] = format\r\n    }\r\n    var rect = renderer.rect();\r\n    rect.attr(attr.rect).css({\r\n        cursor: \"pointer\",\r\n        \"pointer-events\": \"all\"\r\n    }).data(itemData);\r\n    rect.on(hoverEventStart + \".export\", () => rect.attr({\r\n        fill: options.button.hover.backgroundColor\r\n    })).on(hoverEventEnd + \".export\", () => rect.attr({\r\n        fill: null\r\n    }));\r\n    rect.append(menuItem);\r\n    var text = renderer.text(settings.text).css(fontStyle).attr(attr.text).append(menuItem);\r\n    if (\"printing\" === type) {\r\n        renderer.path(null, \"line\").attr(attr.separator).append(menuItem)\r\n    }\r\n    return {\r\n        g: menuItem,\r\n        rect: rect,\r\n        resetState: () => rect.attr({\r\n            fill: null\r\n        }),\r\n        fixPosition: () => {\r\n            var textBBox = text.getBBox();\r\n            text.move(attr.text.x - textBBox.x - (options.rtl ? textBBox.width : 0))\r\n        }\r\n    }\r\n}\r\n\r\nfunction createMenuItems(renderer, options) {\r\n    var items = [];\r\n    if (options.printingEnabled) {\r\n        items.push(createMenuItem(renderer, options, {\r\n            type: \"printing\",\r\n            text: messageLocalization.format(\"vizExport-printingButtonText\"),\r\n            itemIndex: items.length\r\n        }))\r\n    }\r\n    items = options.formats.reduce((r, format) => {\r\n        r.push(createMenuItem(renderer, options, {\r\n            type: \"exporting\",\r\n            text: messageLocalization.getFormatter(\"vizExport-exportButtonText\")(format),\r\n            format: format,\r\n            itemIndex: r.length\r\n        }));\r\n        return r\r\n    }, items);\r\n    return items\r\n}\r\n\r\nfunction getBackgroundColorFromMarkup(markup) {\r\n    var parsedMarkup = GET_COLOR_REGEX.exec(markup);\r\n    return null === parsedMarkup || void 0 === parsedMarkup ? void 0 : parsedMarkup[1]\r\n}\r\nexport var exportFromMarkup = function(markup, options) {\r\n    options.format = validateFormat(options.format) || DEFAULT_EXPORT_FORMAT;\r\n    options.fileName = options.fileName || \"file\";\r\n    options.exportingAction = options.onExporting;\r\n    options.exportedAction = options.onExported;\r\n    options.fileSavingAction = options.onFileSaving;\r\n    options.margin = isDefined(options.margin) ? options.margin : MARGIN;\r\n    options.backgroundColor = isDefined(options.backgroundColor) ? options.backgroundColor : getBackgroundColorFromMarkup(markup) || getTheme().backgroundColor;\r\n    _export(markup, options, getCreatorFunc(options.format))\r\n};\r\nexport var getMarkup = widgets => combineMarkups(widgets).markup;\r\nexport var exportWidgets = function(widgets, options) {\r\n    options = options || {};\r\n    var markupInfo = combineMarkups(widgets, {\r\n        gridLayout: options.gridLayout,\r\n        verticalAlignment: options.verticalAlignment,\r\n        horizontalAlignment: options.horizontalAlignment\r\n    });\r\n    options.width = markupInfo.width;\r\n    options.height = markupInfo.height;\r\n    exportFromMarkup(markupInfo.markup, options)\r\n};\r\nexport var combineMarkups = function(widgets) {\r\n    var options = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\r\n    if (!Array.isArray(widgets)) {\r\n        widgets = [\r\n            [widgets]\r\n        ]\r\n    } else if (!Array.isArray(widgets[0])) {\r\n        widgets = widgets.map(item => [item])\r\n    }\r\n    var compactView = !options.gridLayout;\r\n    var exportItems = widgets.reduce((r, row, rowIndex) => {\r\n        var rowInfo = row.reduce((r, item, colIndex) => {\r\n            var size = item.getSize();\r\n            var backgroundColor = item.option(\"backgroundColor\") || getTheme(item.option(\"theme\")).backgroundColor;\r\n            backgroundColor && -1 === r.backgroundColors.indexOf(backgroundColor) && r.backgroundColors.push(backgroundColor);\r\n            r.hOffset = r.width;\r\n            r.width += size.width;\r\n            r.height = Math.max(r.height, size.height);\r\n            r.itemWidth = Math.max(r.itemWidth, size.width);\r\n            r.items.push({\r\n                markup: item.svg(),\r\n                width: size.width,\r\n                height: size.height,\r\n                c: colIndex,\r\n                r: rowIndex,\r\n                hOffset: r.hOffset\r\n            });\r\n            return r\r\n        }, {\r\n            items: [],\r\n            height: 0,\r\n            itemWidth: 0,\r\n            hOffset: 0,\r\n            width: 0,\r\n            backgroundColors: r.backgroundColors\r\n        });\r\n        r.rowOffsets.push(r.totalHeight);\r\n        r.rowHeights.push(rowInfo.height);\r\n        r.totalHeight += rowInfo.height;\r\n        r.items = r.items.concat(rowInfo.items);\r\n        r.itemWidth = Math.max(r.itemWidth, rowInfo.itemWidth);\r\n        r.maxItemLen = Math.max(r.maxItemLen, rowInfo.items.length);\r\n        r.totalWidth = compactView ? Math.max(r.totalWidth, rowInfo.width) : r.maxItemLen * r.itemWidth;\r\n        return r\r\n    }, {\r\n        items: [],\r\n        rowOffsets: [],\r\n        rowHeights: [],\r\n        itemWidth: 0,\r\n        totalHeight: 0,\r\n        maxItemLen: 0,\r\n        totalWidth: 0,\r\n        backgroundColors: []\r\n    });\r\n    var backgroundColor = 'data-backgroundcolor=\"'.concat(1 === exportItems.backgroundColors.length ? exportItems.backgroundColors[0] : \"\", '\" ');\r\n    var getVOffset = item => {\r\n        var align = options.verticalAlignment;\r\n        var dy = exportItems.rowHeights[item.r] - item.height;\r\n        return exportItems.rowOffsets[item.r] + (\"bottom\" === align ? dy : \"center\" === align ? dy / 2 : 0)\r\n    };\r\n    var getHOffset = item => {\r\n        if (compactView) {\r\n            return item.hOffset\r\n        }\r\n        var align = options.horizontalAlignment;\r\n        var colWidth = exportItems.itemWidth;\r\n        var dx = colWidth - item.width;\r\n        return item.c * colWidth + (\"right\" === align ? dx : \"center\" === align ? dx / 2 : 0)\r\n    };\r\n    var totalHeight = exportItems.totalHeight;\r\n    var totalWidth = exportItems.totalWidth;\r\n    return {\r\n        markup: \"<svg \" + backgroundColor + 'height=\"' + totalHeight + '\" width=\"' + totalWidth + '\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">' + exportItems.items.map(item => '<g transform=\"translate('.concat(getHOffset(item), \",\").concat(getVOffset(item), ')\">').concat(item.markup, \"</g>\")).join(\"\") + \"</svg>\",\r\n        width: totalWidth,\r\n        height: totalHeight\r\n    }\r\n};\r\nexport var ExportMenu = function(params) {\r\n    var renderer = this._renderer = params.renderer;\r\n    this._incidentOccurred = params.incidentOccurred;\r\n    this._exportTo = params.exportTo;\r\n    this._print = params.print;\r\n    this._shadow = renderer.shadowFilter(\"-50%\", \"-50%\", \"200%\", \"200%\", SHADOW_OFFSET, 6, SHADOW_BLUR);\r\n    this._shadow.attr({\r\n        opacity: .8\r\n    });\r\n    this._group = renderer.g().attr({\r\n        class: EXPORT_CSS_CLASS,\r\n        [HIDDEN_FOR_EXPORT]: true\r\n    }).linkOn(renderer.root, {\r\n        name: \"export-menu\",\r\n        after: \"peripheral\"\r\n    });\r\n    this._buttonGroup = renderer.g().attr({\r\n        class: EXPORT_CSS_CLASS + \"-button\"\r\n    }).append(this._group);\r\n    this._listGroup = renderer.g().attr({\r\n        class: EXPORT_CSS_CLASS + \"-list\"\r\n    }).append(this._group);\r\n    this._overlay = renderer.rect(-LIST_WIDTH + BUTTON_SIZE, BUTTON_SIZE + LIST_PADDING_TOP, LIST_WIDTH, 0);\r\n    this._overlay.attr({\r\n        \"stroke-width\": LIST_STROKE_WIDTH,\r\n        cursor: \"pointer\",\r\n        rx: 4,\r\n        ry: 4,\r\n        filter: this._shadow.id\r\n    });\r\n    this._overlay.data({\r\n        \"export-element-type\": \"list\"\r\n    });\r\n    this.validFormats = getValidFormats();\r\n    this._subscribeEvents()\r\n};\r\nextend(ExportMenu.prototype, {\r\n    getLayoutOptions() {\r\n        if (this._hiddenDueToLayout) {\r\n            return {\r\n                width: 0,\r\n                height: 0,\r\n                cutSide: \"vertical\",\r\n                cutLayoutSide: \"top\"\r\n            }\r\n        }\r\n        var bBox = this._buttonGroup.getBBox();\r\n        bBox.cutSide = \"vertical\";\r\n        bBox.cutLayoutSide = \"top\";\r\n        bBox.height += MARGIN;\r\n        bBox.position = {\r\n            vertical: \"top\",\r\n            horizontal: \"right\"\r\n        };\r\n        bBox.verticalAlignment = \"top\";\r\n        bBox.horizontalAlignment = \"right\";\r\n        return bBox\r\n    },\r\n    shift(_, y) {\r\n        this._group.attr({\r\n            translateY: this._group.attr(\"translateY\") + y\r\n        })\r\n    },\r\n    draw(width, height, canvas) {\r\n        this._group.move(width - BUTTON_SIZE - SHADOW_OFFSET - SHADOW_BLUR + canvas.left, Math.floor(height / 2 - BUTTON_SIZE / 2));\r\n        var layoutOptions = this.getLayoutOptions();\r\n        if (layoutOptions.width > width || layoutOptions.height > height) {\r\n            this.freeSpace()\r\n        }\r\n        return this\r\n    },\r\n    show() {\r\n        this._group.linkAppend()\r\n    },\r\n    hide() {\r\n        this._group.linkRemove()\r\n    },\r\n    setOptions(options) {\r\n        this._options = options;\r\n        if (options.formats) {\r\n            options.formats = options.formats.reduce((r, format) => {\r\n                format = validateFormat(format, this._incidentOccurred, this.validFormats);\r\n                format && r.push(format);\r\n                return r\r\n            }, [])\r\n        } else {\r\n            options.formats = this.validFormats.supported.slice()\r\n        }\r\n        options.printingEnabled = void 0 === options.printingEnabled ? true : options.printingEnabled;\r\n        if (options.enabled && (options.formats.length || options.printingEnabled)) {\r\n            this.show();\r\n            this._updateButton();\r\n            this._updateList();\r\n            this._hideList()\r\n        } else {\r\n            this.hide()\r\n        }\r\n    },\r\n    dispose() {\r\n        this._unsubscribeEvents();\r\n        this._group.linkRemove().linkOff();\r\n        this._group.dispose();\r\n        this._shadow.dispose()\r\n    },\r\n    layoutOptions() {\r\n        return this._options.enabled && {\r\n            horizontalAlignment: \"right\",\r\n            verticalAlignment: \"top\",\r\n            weak: true\r\n        }\r\n    },\r\n    measure() {\r\n        this._fillSpace();\r\n        var margin = this._options.button.margin;\r\n        return [BUTTON_SIZE + margin.left + margin.right, BUTTON_SIZE + margin.top + margin.bottom]\r\n    },\r\n    move(rect) {\r\n        var margin = this._options.button.margin;\r\n        this._group.attr({\r\n            translateX: Math.round(rect[0]) + margin.left,\r\n            translateY: Math.round(rect[1]) + margin.top\r\n        })\r\n    },\r\n    _fillSpace() {\r\n        this._hiddenDueToLayout = false;\r\n        this.show()\r\n    },\r\n    freeSpace() {\r\n        this._incidentOccurred(\"W2107\");\r\n        this._hiddenDueToLayout = true;\r\n        this.hide()\r\n    },\r\n    _hideList() {\r\n        this._listGroup.remove();\r\n        this._listShown = false;\r\n        this._setButtonState(\"default\");\r\n        this._menuItems.forEach(item => item.resetState())\r\n    },\r\n    _showList() {\r\n        this._listGroup.append(this._group);\r\n        this._listShown = true;\r\n        this._menuItems.forEach(item => item.fixPosition())\r\n    },\r\n    _setButtonState(state) {\r\n        var style = this._options.button[state];\r\n        this._button.attr({\r\n            stroke: style.borderColor,\r\n            fill: style.backgroundColor\r\n        });\r\n        this._icon.attr({\r\n            fill: style.color\r\n        })\r\n    },\r\n    _subscribeEvents() {\r\n        this._renderer.root.on(pointerEvents.up + \".export\", e => {\r\n            var elementType = e.target[EXPORT_DATA_KEY];\r\n            if (!elementType) {\r\n                if (this._button) {\r\n                    this._hideList()\r\n                }\r\n                return\r\n            }\r\n            if (\"button\" === elementType) {\r\n                if (this._listShown) {\r\n                    this._setButtonState(\"default\");\r\n                    this._hideList()\r\n                } else {\r\n                    this._setButtonState(\"focus\");\r\n                    this._showList()\r\n                }\r\n            } else if (\"printing\" === elementType) {\r\n                this._print();\r\n                this._hideList()\r\n            } else if (\"exporting\" === elementType) {\r\n                this._exportTo(e.target[FORMAT_DATA_KEY]);\r\n                this._hideList()\r\n            }\r\n        });\r\n        this._listGroup.on(pointerActions, e => e.stopPropagation());\r\n        this._buttonGroup.on(pointerEvents.enter, () => this._setButtonState(\"hover\"));\r\n        this._buttonGroup.on(pointerEvents.leave, () => this._setButtonState(this._listShown ? \"focus\" : \"default\"));\r\n        this._buttonGroup.on(pointerEvents.down + \".export\", () => this._setButtonState(\"active\"))\r\n    },\r\n    _unsubscribeEvents() {\r\n        this._renderer.root.off(\".export\");\r\n        this._listGroup.off();\r\n        this._buttonGroup.off()\r\n    },\r\n    _updateButton() {\r\n        var renderer = this._renderer;\r\n        var options = this._options;\r\n        var exportData = {\r\n            \"export-element-type\": \"button\"\r\n        };\r\n        if (!this._button) {\r\n            this._button = renderer.rect(0, 0, BUTTON_SIZE, BUTTON_SIZE).append(this._buttonGroup);\r\n            this._button.attr({\r\n                rx: 4,\r\n                ry: 4,\r\n                fill: options.button.default.backgroundColor,\r\n                stroke: options.button.default.borderColor,\r\n                \"stroke-width\": 1,\r\n                cursor: \"pointer\"\r\n            });\r\n            this._button.data(exportData);\r\n            this._icon = renderer.path(ICON_COORDS).append(this._buttonGroup);\r\n            this._icon.attr({\r\n                fill: options.button.default.color,\r\n                cursor: \"pointer\"\r\n            });\r\n            this._icon.data(exportData);\r\n            this._buttonGroup.setTitle(messageLocalization.format(\"vizExport-titleMenuText\"))\r\n        }\r\n    },\r\n    _updateList() {\r\n        var options = this._options;\r\n        var buttonDefault = options.button.default;\r\n        var listGroup = this._listGroup;\r\n        var items = createMenuItems(this._renderer, options);\r\n        this._shadow.attr({\r\n            color: options.shadowColor\r\n        });\r\n        this._overlay.attr({\r\n            height: items.length * MENU_ITEM_HEIGHT + 2 * LIST_STROKE_WIDTH,\r\n            fill: buttonDefault.backgroundColor,\r\n            stroke: buttonDefault.borderColor\r\n        });\r\n        listGroup.clear();\r\n        this._overlay.append(listGroup);\r\n        items.forEach(item => item.g.append(listGroup));\r\n        this._menuItems = items\r\n    }\r\n});\r\n\r\nfunction getExportOptions(widget, exportOptions, fileName, format) {\r\n    if (format || exportOptions.format) {\r\n        format = validateFormat(format || exportOptions.format, widget._incidentOccurred)\r\n    }\r\n    var {\r\n        width: width,\r\n        height: height\r\n    } = widget.getSize();\r\n    return {\r\n        format: format || DEFAULT_EXPORT_FORMAT,\r\n        fileName: fileName || exportOptions.fileName || \"file\",\r\n        proxyUrl: exportOptions.proxyUrl,\r\n        backgroundColor: exportOptions.backgroundColor,\r\n        width: width,\r\n        height: height,\r\n        margin: exportOptions.margin,\r\n        svgToCanvas: exportOptions.svgToCanvas,\r\n        forceProxy: exportOptions.forceProxy,\r\n        exportingAction: widget._createActionByOption(\"onExporting\", {\r\n            excludeValidators: [\"disabled\"]\r\n        }),\r\n        exportedAction: widget._createActionByOption(\"onExported\", {\r\n            excludeValidators: [\"disabled\"]\r\n        }),\r\n        fileSavingAction: widget._createActionByOption(\"onFileSaving\", {\r\n            excludeValidators: [\"disabled\"]\r\n        })\r\n    }\r\n}\r\nexport var plugin = {\r\n    name: \"export\",\r\n    init() {\r\n        this._exportMenu = new ExportMenu({\r\n            renderer: this._renderer,\r\n            incidentOccurred: this._incidentOccurred,\r\n            print: () => this.print(),\r\n            exportTo: format => this.exportTo(void 0, format)\r\n        });\r\n        this._layout.add(this._exportMenu)\r\n    },\r\n    dispose() {\r\n        this._exportMenu.dispose()\r\n    },\r\n    members: {\r\n        _getExportMenuOptions() {\r\n            return extend({}, this._getOption(\"export\"), {\r\n                rtl: this._getOption(\"rtlEnabled\", true)\r\n            })\r\n        },\r\n        _disablePointerEvents() {\r\n            var pointerEventsValue = this._renderer.root.attr(\"pointer-events\");\r\n            this._renderer.root.attr({\r\n                \"pointer-events\": \"none\"\r\n            });\r\n            return pointerEventsValue\r\n        },\r\n        exportTo(fileName, format) {\r\n            var menu = this._exportMenu;\r\n            var options = getExportOptions(this, this._getOption(\"export\") || {}, fileName, format);\r\n            menu && menu.hide();\r\n            var pointerEventsValue = this._disablePointerEvents();\r\n            var promise = _export(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(logger.error).always(() => {\r\n                this._renderer.root.attr({\r\n                    \"pointer-events\": pointerEventsValue\r\n                })\r\n            });\r\n            menu && menu.show();\r\n            return promise\r\n        },\r\n        print() {\r\n            var menu = this._exportMenu;\r\n            var options = getExportOptions(this, this._getOption(\"export\") || {});\r\n            options.exportingAction = null;\r\n            options.exportedAction = null;\r\n            options.margin = 0;\r\n            options.format = \"PNG\";\r\n            options.forceProxy = true;\r\n            options.fileSavingAction = eventArgs => {\r\n                print(\"data:image/png;base64,\".concat(eventArgs.data), {\r\n                    width: options.width,\r\n                    __test: options.__test\r\n                });\r\n                eventArgs.cancel = true\r\n            };\r\n            var pointerEventsValue = this._disablePointerEvents();\r\n            menu && menu.hide();\r\n            var promise = _export(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(logger.error).always(() => {\r\n                this._renderer.root.attr({\r\n                    \"pointer-events\": pointerEventsValue\r\n                })\r\n            });\r\n            menu && menu.show();\r\n            return promise\r\n        }\r\n    },\r\n    customize(constructor) {\r\n        var proto = constructor.prototype;\r\n        constructor.addChange({\r\n            code: \"EXPORT\",\r\n            handler() {\r\n                this._exportMenu.setOptions(this._getExportMenuOptions());\r\n                this._change([\"LAYOUT\"])\r\n            },\r\n            isThemeDependent: true,\r\n            isOptionChange: true,\r\n            option: \"export\"\r\n        });\r\n        proto._optionChangesMap.onExporting = \"EXPORT\";\r\n        proto._optionChangesMap.onExported = \"EXPORT\";\r\n        proto._optionChangesMap.onFileSaving = \"EXPORT\"\r\n    },\r\n    fontFields: [\"export.font\"]\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}